!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("@soaa/ng2-ui-auth",["exports","@angular/core","rxjs","rxjs/operators","@angular/common/http"],e):e((t.soaa=t.soaa||{},t.soaa["ng2-ui-auth"]={}),t.ng.core,t.rxjs,t.rxjs.operators,t.ng.common.http)}(this,function(t,e,c,h,r){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};var l=function(){return(l=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function s(e,s,a,u){return new(a||(a=Promise))(function(t,o){function n(t){try{i(u.next(t))}catch(e){o(e)}}function r(t){try{i(u["throw"](t))}catch(e){o(e)}}function i(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}i((u=u.apply(e,s||[])).next())})}function a(n,r){var i,s,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function o(t){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,s&&(a=2&t[0]?s["return"]:t[0]?s["throw"]||((a=s["return"])&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function o(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,r,i=o.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return s}function f(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}function d(t,e){return/^(?:[a-z]+:)?\/\//i.test(e)?e:[t,e].join("/").replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")}function u(e){return Object.keys(e).map(function(t){return e[t]?encodeURIComponent(t)+"="+encodeURIComponent(e[t]):t}).join("&")}function g(t){t||"undefined"==typeof window||(t=window);try{return t&&t.location?t.location.origin?t.location.origin:t.location.protocol+"//"+t.location.hostname+(t.location.port?":"+t.location.port:""):null}catch(e){return null}}var n={facebook:{name:"facebook",url:"/auth/facebook",redirectUri:g()+"/",authorizationEndpoint:"https://www.facebook.com/v2.5/dialog/oauth",additionalUrlParams:{display:"popup"},scope:["email"],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:580,height:400}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",additionalUrlParams:{display:"popup",prompt:undefined,login_hint:undefined,access_type:undefined,include_granted_scopes:undefined,"openid.realm":undefined,hd:undefined},scope:["openid","profile","email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:452,height:633},state:function(){return encodeURIComponent(Math.random().toString(36).substr(2))}},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",scope:["user:email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",scope:["basic"],scopeDelimiter:"+",oauthType:"2.0"},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/uas/oauth2/authorization",scope:["r_emailaddress"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:527,height:582},state:"STATE"},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",oauthType:"1.0",popupOptions:{width:495,height:645}},twitch:{name:"twitch",url:"/auth/twitch",authorizationEndpoint:"https://api.twitch.tv/kraken/oauth2/authorize",scope:["user_read"],scopeDelimiter:" ",additionalUrlParams:{display:"popup"},oauthType:"2.0",popupOptions:{width:500,height:560}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",additionalUrlParams:{display:"popup"},scope:["wl.emails"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:500,height:560}},yahoo:{name:"yahoo",url:"/auth/yahoo",authorizationEndpoint:"https://api.login.yahoo.com/oauth2/request_auth",scope:[],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:559,height:519}},bitbucket:{name:"bitbucket",url:"/auth/bitbucket",authorizationEndpoint:"https://bitbucket.org/site/oauth2/authorize",redirectUri:g()+"/",scope:["email"],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:1028,height:529}},spotify:{name:"spotify",url:"/auth/spotify",authorizationEndpoint:"https://accounts.spotify.com/authorize",scope:["","user-read-email"],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:500,height:530},state:function(){return encodeURIComponent(Math.random().toString(36).substr(2))}}},p={NONE:"none",MEMORY:"memory",LOCAL_STORAGE:"localStorage",SESSION_STORAGE:"sessionStorage",COOKIE:"cookie",SESSION_COOKIE:"sessionCookie"},y=new e.InjectionToken("config.options"),v=function(){function t(t){this.options={withCredentials:!1,tokenRoot:null,baseUrl:"/",loginUrl:"/auth/login",signupUrl:"/auth/signup",unlinkUrl:"/auth/unlink/",tokenName:"token",refreshTokenName:"refresh_token",tokenSeparator:"_",tokenPrefix:"ng2-ui-auth",authHeader:"Authorization",authToken:"Bearer",storageType:p.LOCAL_STORAGE,cordova:undefined,resolveToken:function(t,e){var o=t&&(t.access_token||t.token||t.data);if(!o)return null;if("string"==typeof o)return{accessToken:o,refreshToken:t[e.refreshTokenName]};if("object"!=typeof o)return null;var n=e.tokenRoot&&e.tokenRoot.split(".").reduce(function(t,e){return t[e]},o),r=n?n[e.tokenName]:o[e.tokenName],i=n?n[e.refreshTokenName]:o[e.refreshTokenName];return r?{accessToken:r,refreshToken:i}:null},providers:{}},this.options=l({},this.options,t),this.mergeWithDefaultProviders()}return t.prototype.updateProviders=function(t){this.options.providers=l({},this.options.providers||{},t),this.mergeWithDefaultProviders()},t.prototype.mergeWithDefaultProviders=function(){var e=this;Object.keys(this.options.providers).forEach(function(t){t in n&&(e.options.providers[t]=l({},n[t],e.options.providers[t]))})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[y]}]}]},t}(),m=function N(){},k=function(o){function t(t){var e=o.call(this)||this;return e.config=t,e.store={},e.storageType=p.MEMORY,e.updateStorageType(t.options.storageType)||console.warn(t.options.storageType+" is not available."),e}return function n(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}(t,o),t.prototype.updateStorageType=function(t){return!!this.checkIsStorageAvailable(t)&&(this.storageType=t,!0)},t.prototype.get=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){switch(this.storageType){case p.COOKIE:case p.SESSION_COOKIE:return[2,Promise.resolve(this.getCookie(e))];case p.LOCAL_STORAGE:case p.SESSION_STORAGE:return[2,Promise.resolve(window[this.storageType].getItem(e))];case p.MEMORY:return[2,Promise.resolve(this.store[e])];case p.NONE:default:return[2,Promise.resolve(null)]}return[2]})})},t.prototype.set=function(e,o,n){return s(this,void 0,void 0,function(){return a(this,function(t){switch(this.storageType){case p.COOKIE:case p.SESSION_COOKIE:this.setCookie(e,o,this.storageType===p.COOKIE?n:"");break;case p.LOCAL_STORAGE:case p.SESSION_STORAGE:window[this.storageType].setItem(e,o);break;case p.MEMORY:this.store[e]=o}return[2]})})},t.prototype.remove=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){switch(this.storageType){case p.COOKIE:case p.SESSION_COOKIE:this.removeCookie(e);break;case p.LOCAL_STORAGE:case p.SESSION_STORAGE:window[this.storageType].removeItem(e);break;case p.MEMORY:delete this.store[e]}return[2]})})},t.prototype.checkIsStorageAvailable=function(t){switch(t){case p.COOKIE:case p.SESSION_COOKIE:return this.isCookieStorageAvailable();case p.LOCAL_STORAGE:case p.SESSION_STORAGE:return this.isWindowStorageAvailable(t);case p.NONE:case p.MEMORY:return!0;default:return!1}},t.prototype.isWindowStorageAvailable=function(t){try{var e=window&&t in window&&null!==window[t];if(e){var o=Math.random().toString(36).substring(7);window[t].setItem(o,""),window[t].removeItem(o)}return e}catch(n){return!1}},t.prototype.isCookieStorageAvailable=function(){try{if(document&&"cookie"in document){var t=Math.random().toString(36).substring(7);this.setCookie(t,"test",new Date(Date.now()+6e4).toUTCString());var e=this.getCookie(t);return this.removeCookie(t),"test"===e}return!1}catch(o){return!1}},t.prototype.setCookie=function(t,e,o,n){void 0===o&&(o=""),void 0===n&&(n="/"),document.cookie=t+"="+e+(o?"; expires="+o:"")+"; path="+n},t.prototype.removeCookie=function(t,e){void 0===e&&(e="/"),this.setCookie(t,"",new Date(0).toUTCString(),e)},t.prototype.getCookie=function(t){return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)"+t+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:v}]},t}(m),w=function(){function t(){}return t.prototype.requestTokenRefresh=function(t){return c.EMPTY},t.decorators=[{type:e.Injectable}],t}(),b=function(){function t(t,e,o){this.storage=t,this.config=e,this.tokenRefreshService=o,this.tokenName=this.config.options.tokenPrefix?[this.config.options.tokenPrefix,this.config.options.tokenName].join(this.config.options.tokenSeparator):this.config.options.tokenName,this.refreshTokenName=this.config.options.tokenPrefix?[this.config.options.tokenPrefix,this.config.options.refreshTokenName].join(this.config.options.tokenSeparator):this.config.options.refreshTokenName}return t.prototype.getRefreshToken=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.storage.get(this.refreshTokenName)];case 1:return[2,t.sent()]}})})},t.prototype.getToken=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.storage.get(this.tokenName)];case 1:return[2,t.sent()]}})})},t.prototype.getPayload=function(r){return s(this,void 0,void 0,function(){var o,n;return a(this,function(t){switch(t.label){case 0:return r?[3,2]:[4,this.getToken()];case 1:r=t.sent(),t.label=2;case 2:if(r&&3===r.split(".").length)try{return o=r.split(".")[1],n=o.replace(/-/g,"+").replace(/_/g,"/"),[2,JSON.parse(this.b64DecodeUnicode(n))]}catch(e){return[2,undefined]}return[2]}})})},t.prototype.setToken=function(n){return s(this,void 0,void 0,function(){var e,o;return a(this,function(t){switch(t.label){case 0:return n?(e="string"==typeof n?{accessToken:n}:this.config.options.resolveToken(n,this.config.options)).accessToken?[4,this.getExpirationDate(e.accessToken)]:[3,3]:[2,null];case 1:return o=t.sent(),[4,this.storage.set(this.tokenName,e.accessToken,o?o.toUTCString():"")];case 2:t.sent(),t.label=3;case 3:return e.refreshToken?[4,this.getExpirationDate(e.refreshToken)]:[3,6];case 4:return o=t.sent(),[4,this.storage.set(this.refreshTokenName,e.refreshToken,o?o.toUTCString():"")];case 5:t.sent(),t.label=6;case 6:return[2,e]}})})},t.prototype.removeToken=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.storage.remove(this.tokenName)];case 1:return t.sent(),[2]}})})},t.prototype.isAuthenticated=function(r){return s(this,void 0,void 0,function(){var e,o,n;return a(this,function(t){switch(t.label){case 0:return r?[3,2]:[4,this.getToken()];case 1:r=t.sent(),t.label=2;case 2:return r?this.isValidToken(r)?[2,!0]:[4,this.getRefreshToken()]:[3,10];case 3:return(e=t.sent())?this.isValidToken(e)?[4,this.tokenRefreshService.requestTokenRefresh(e).toPromise()]:[3,6]:[3,8];case 4:return o=t.sent(),[4,this.setToken(o)];case 5:return[2,(n=t.sent())&&this.isValidToken(n.accessToken)];case 6:return[4,this.storage.remove(this.refreshTokenName)];case 7:t.sent(),t.label=8;case 8:return[4,this.storage.remove(this.tokenName)];case 9:t.sent(),t.label=10;case 10:return[2,!1]}})})},t.prototype.isValidToken=function(t){if(3===t.split(".").length)try{var e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=JSON.parse(this.b64DecodeUnicode(e)).exp;if(o)return!(Math.round((new Date).getTime()/1e3)>=o)}catch(n){return!0}return!0},t.prototype.getExpirationDate=function(n){return s(this,void 0,void 0,function(){var e,o;return a(this,function(t){switch(t.label){case 0:return n?[3,2]:[4,this.getToken()];case 1:n=t.sent(),t.label=2;case 2:return[4,this.getPayload(n)];case 3:return(e=t.sent())&&e.exp&&Math.round((new Date).getTime()/1e3)<e.exp?((o=new Date(0)).setUTCSeconds(e.exp),[2,o]):[2,null]}})})},t.prototype.logout=function(){var t=this;return c.Observable.create(function(e){return s(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.storage.remove(this.tokenName)];case 1:return t.sent(),e.next(),e.complete(),[2]}})})})},t.prototype.setStorageType=function(t){return this.storage.updateStorageType(t)},t.prototype.b64DecodeUnicode=function(t){return decodeURIComponent(Array.prototype.map.call(atob(t),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:m},{type:v},{type:w}]},t}(),T=function(){function t(t,e){this.shared=t,this.config=e}return t.prototype.intercept=function(r,i){var t=this.config.options,s=t.authHeader,a=t.authToken;return c.from(Promise.all([this.shared.getToken(),this.shared.isAuthenticated()])).pipe(h.switchMap(function(t){var e,o=t[0],n=t[1]&&!r.headers.has(s)?r.clone({setHeaders:(e={},e[s]=a+" "+o,e)}):r;return i.handle(n)}))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:b},{type:v}]},t}(),O=function(){function t(){}return t.prototype.open=function(t,e,o){void 0===o&&(o=this.isCordovaApp());var n=this.stringifyOptions(this.prepareOptions(e.popupOptions)),r=o?"_blank":e.name,i="undefined"!=typeof window?window.open(t,r,n):null;return i?(i.focus&&i.focus(),c.of(i)):c.empty()},t.prototype.waitForClose=function(t,e,o){return void 0===e&&(e=this.isCordovaApp()),void 0===o&&(o=g()),e?this.eventListener(t,o):this.pollPopup(t,o)},t.prototype.eventListener=function(a,u){var p=this;if(void 0===u&&(u=g()),!a)throw new Error("Popup was not created");return c.merge(c.fromEvent(a,"exit").pipe(h.delay(100),h.map(function(){throw new Error("Authentication Canceled")})),c.fromEvent(a,"loadstart")).pipe(h.switchMap(function(t){if(!a||a.closed)return c.Observable["throw"](new Error("Authentication Canceled"));if(0!==t.url.indexOf(u))return c.empty();var e=document.createElement("a");if(e.href=t.url,e.search||e.hash){var o=e.search.substring(1).replace(/\/$/,""),n=e.hash.substring(1).replace(/\/$/,""),r=p.parseQueryString(n),i=p.parseQueryString(o),s=l({},i,r);if(a.close(),s.error)throw s.error;return c.of(s)}return c.empty()}),h.take(1))},t.prototype.pollPopup=function(s,a){var u=this;return void 0===a&&(a=g()),c.interval(50).pipe(h.switchMap(function(){if(!s||s.closed)return c.throwError(new Error("Authentication Canceled"));var t=g(s);if(!t||0!==a.indexOf(t)&&0!==t.indexOf(a)||!s.location.search&&!s.location.hash)return c.empty();var e=s.location.search.substring(1).replace(/\/$/,""),o=s.location.hash.substring(1).replace(/[\/$]/,""),n=u.parseQueryString(o),r=u.parseQueryString(e);s.close();var i=l({},r,n);if(i.error)throw i.error;return c.of(i)}),h.take(1))},t.prototype.prepareOptions=function(t){var e=(t=t||{}).width||500,o=t.height||500;return l({width:e,height:o,left:window.screenX+(window.outerWidth-e)/2,top:window.screenY+(window.outerHeight-o)/2.5,toolbar:t.visibleToolbar?"yes":"no"},t)},t.prototype.stringifyOptions=function(e){return Object.keys(e).map(function(t){return null===e[t]||e[t]===undefined?t:t+"="+e[t]}).join(",")},t.prototype.parseQueryString=function(t){var o;return t.split("&").reduce(function(t,e){return e&&(o=e.split("="),t[decodeURIComponent(o[0])]="undefined"==typeof o[1]||decodeURIComponent(o[1])),t},{})},t.prototype.isCordovaApp=function(){return"object"==typeof cordova||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")},t.decorators=[{type:e.Injectable}],t}(),S=function(){function t(t,e,o){this.http=t,this.popup=e,this.config=o}return t.prototype.open=function(n,r){var i=this,t=this.config.options.baseUrl?d(this.config.options.baseUrl,n.url):n.url;return this.popup.open("about:blank",n,this.config.options.cordova).pipe(h.switchMap(function(o){return i.http.post(t,n).pipe(h.tap(function(t){return o?o.location.replace([n.authorizationEndpoint,u(t)].join("?")):undefined}),h.switchMap(function(e){return i.popup.waitForClose(o,i.config.options.cordova,n.redirectUri).pipe(h.map(function(t){return{authorizationData:e,oauthData:t}}))}))}),h.switchMap(function(t){var e=t.authorizationData,o=t.oauthData;return i.exchangeForToken(n,e,o,r)}))},t.prototype.exchangeForToken=function(t,e,o,n){var r={oauthOptions:t,authorizationData:e,oauthData:o,userData:n},i=this.config.options,s=i.withCredentials,a=i.baseUrl,u=t.method,p=void 0===u?"POST":u,c=t.url,h=a?d(a,c):c;return this.http.request(p,h,{body:r,withCredentials:s})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:O},{type:v}]},t}(),C=function(){function t(t,e,o){this.http=t,this.popup=e,this.config=o}return t.prototype.open=function(e,o){var n=this,r=this.getAuthorizationData(e),t=[e.authorizationEndpoint,u(r)].join("?");return this.popup.open(t,e,this.config.options.cordova).pipe(h.switchMap(function(t){return t?n.popup.waitForClose(t,n.config.options.cordova,e.redirectUri):c.empty()}),h.switchMap(function(t){if("token"===e.responseType||!e.url)return c.of(t);if(t.state&&t.state!==r.state)throw new Error('OAuth "state" mismatch');return n.exchangeForToken(e,r,t,o)}))},t.prototype.exchangeForToken=function(t,e,o,n){var r={authorizationData:e,oauthData:o,userData:n},i=this.config.options,s=i.baseUrl,a=i.withCredentials,u=t.url,p=t.method,c=void 0===p?"POST":p,h=s?d(s,u):u;return this.http.request(c,h,{body:r,withCredentials:a})},t.prototype.getAuthorizationData=function(t){var e=t.responseType,o=void 0===e?"code":e,n=t.clientId,r=t.redirectUri,i=void 0===r?g()||"":r,s=t.scopeDelimiter,a=void 0===s?",":s,u=t.scope,p=t.state,c=t.additionalUrlParams,h="function"==typeof p?p():p;return f([["response_type",o],["client_id",n],["redirect_uri",i]],p?[["state",h]]:[],u?[["scope",u.join(a)]]:[],c?Object.keys(c).map(function(t){var e=c[t];return"string"==typeof e?[t,e]:"function"==typeof e?[t,e()]:null===e?[t,""]:["",""]}):[]).filter(function(t){return!!t[0]}).reduce(function(t,e){var o;return l({},t,((o={})[e[0]]=e[1],o))},{})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:O},{type:v}]},t}(),E=function(){function t(t,e,o,n){this.http=t,this.shared=e,this.config=o,this.popup=n,this.depProviders=[{provide:r.HttpClient,useValue:this.http},{provide:O,useValue:this.popup},{provide:v,useValue:this.config}],this.deps=[r.HttpClient,O,v]}return t.prototype.authenticate=function(e,t){var o=this;return this.providerOf(e).open(this.config.options.providers[e],t||{}).pipe(h.switchMap(function(t){return o.config.options.providers[e].url?c.from(o.shared.setToken(t)).pipe(h.mapTo(t)):c.of(t)}))},t.prototype.providerOf=function(t){return"1.0"===this.config.options.providers[t].oauthType?e.Injector.create({providers:f(this.depProviders,[{provide:S,deps:this.deps}])}).get(S):e.Injector.create({providers:f(this.depProviders,[{provide:C,deps:this.deps}])}).get(C)},t.prototype.unlink=function(t,e,o){return void 0===e&&(e=d(this.config.options.baseUrl,this.config.options.unlinkUrl)),void 0===o&&(o="POST"),this.http.request(o,e,{body:{provider:t}})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:b},{type:v},{type:O}]},t}(),I=function(){function t(t,e,o){this.http=t,this.shared=e,this.config=o}return t.prototype.login=function(t,e){var o=this;return this.http.post(e||d(this.config.options.baseUrl,this.config.options.loginUrl),t).pipe(h.tap(function(t){return o.shared.setToken(t)}))},t.prototype.signup=function(t,e){return this.http.post(e||d(this.config.options.baseUrl,this.config.options.signupUrl),t)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:b},{type:v}]},t}(),P=function(){function t(t,e,o){this.shared=t,this.local=e,this.oauth=o}return t.prototype.login=function(t,e){return this.local.login(t,e)},t.prototype.signup=function(t,e){return this.local.signup(t,e)},t.prototype.logout=function(){return this.shared.logout()},t.prototype.authenticate=function(t,e){return this.oauth.authenticate(t,e)},t.prototype.link=function(t,e){return this.oauth.authenticate(t,e)},t.prototype.unlink=function(t,e){return this.oauth.unlink(t,e)},t.prototype.isAuthenticated=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.isAuthenticated()];case 1:return[2,t.sent()]}})})},t.prototype.getToken=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.getToken()];case 1:return[2,t.sent()]}})})},t.prototype.setToken=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.setToken(e)];case 1:return t.sent(),[2]}})})},t.prototype.removeToken=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.removeToken()];case 1:return t.sent(),[2]}})})},t.prototype.getPayload=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.getPayload()];case 1:return[2,t.sent()]}})})},t.prototype.setStorageType=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.setStorageType(e)];case 1:return[2,t.sent()]}})})},t.prototype.getExpirationDate=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.shared.getExpirationDate()];case 1:return[2,t.sent()]}})})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:b},{type:I},{type:E}]},t}(),_=function(){function o(){}return o.forRoot=function(t,e){return void 0===e&&(e=!0),{ngModule:o,providers:f(t?[{provide:y,useValue:t}]:[],[{provide:v,useClass:v,deps:[y]},{provide:m,useClass:k,deps:[v]},{provide:b,useClass:b,deps:[m,v]},{provide:I,useClass:I,deps:[r.HttpClient,b,v]},{provide:O,useClass:O,deps:[v]},{provide:E,useClass:E,deps:[r.HttpClient,b,v,O]},{provide:P,useClass:P,deps:[b,I,E]}],e?[{provide:r.HTTP_INTERCEPTORS,useClass:T,multi:!0,deps:[b,v]}]:[])}},o.decorators=[{type:e.NgModule,args:[{imports:[r.HttpClientModule],declarations:[],exports:[]}]}],o}();t.Ng2UiAuthModule=_,t.LocalService=I,t.Oauth2Service=C,t.Oauth1Service=S,t.PopupService=O,t.OauthService=E,t.SharedService=b,t.StorageService=m,t.BrowserStorageService=k,t.AuthService=P,t.ConfigService=v,t.TokenRefreshService=w,t.JwtInterceptor=T,t.CONFIG_OPTIONS=y,t.StorageType=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=soaa-ng2-ui-auth.umd.min.js.map